# ИДЗ 3 Дергилёв Марк БПИ 236 Вариант 24

Задача о программистах. В отделе работают три программиста. Каждый программист пишет свою программу и отдает ее на
проверку одному из двух оставшихся программистов, выбирая его
случайно и ожидая окончания проверки. Программист начинает
проверять чужую программу, когда его собственная уже написа-
на и передана на проверку. По завершении проверки, программист
возвращает программу с результатом (формируемым случайно по
любому из выбранных Вами законов): программа написана пра-
вильно или неправильно. Программист «спит», если отправил свою программу и не проверяет чужую программу. Программист «просыпается», когда получает заключение от другого программиста.
Если программа признана правильной,программист пишет другую
программу, если программа признана неправильной, программист
исправляет ее и отправляет на проверку тому же программисту,
который ее проверял. К исправлению своей программы он приступает, завершив проверку чужой программы. При наличии в очереди проверяемых программ и приходе заключения о неправильной своей программы программист может выбирать любую из возможных работ. Необходимо учесть, что кто-то из программистов может получать несколько программ на проверку.
Создать клиент–серверное приложение, моделирующее работу программистов.
Каждый программист — отдельный клиент. Сервер обеспечивает передачу данных между клиентами.


## Описание программы на оценку 4-5

Файлы решения - `server_5.cpp` и `client_5.cpp`

Команды для компиляции:
`g++ -std=c++17  -o server server_5.cpp -pthread`
`g++ -std=c++17  -o client client_5.cpp -pthread `

Для запуска программы вначале запускаем сервер в отдельном терминале:
`./server 127.0.0.1 8000`

Затем трех клиентов в трех разных терминалах:
`./client 127.0.0.1 8000`
`./client 127.0.0.1 8000`
`./client 127.0.0.1 8000`

Завершается программа путем SIGINT для каждого процесса.

Благодаря возможности задать адрес и порт сервера, а так же у клиентов адрес и порт сервера, к которому они подключаются, обеспечивается возможность разнести клиентов и сервер по разным компьютерам.

**Сценарий работы приложения:**

Сервер хранит три очереди заданий для каждого из клиентов, в которую попадают задания для конкретного клиента от других клиентов. 

Сервер является прокси между клиентами и просто пересылает от одного клиента сообщение к другому. 

Логика работы клиента:

В целом логика работы хорошо описана в условии задания, и она реализована так же в моей программе.

**Примерная схема работы:**
Клиент запускается и подключается к серверу.

Клиент ждет от сервера сообщение `start [id]` при получении которого он начинает работать и устанавливает свой id на id.

[ЦИКЛ]
Начинает генерировать код

Если нужно выбрать нового проверяющего (со старта нужно, затем в зависимости от результата проверки), клиент рандомно выбирает id и отправляет к серверу запрос, чтобы клиент с выбранным id проверил его код.

После отправки запроса на проверку, клиент обращается к серверу чтобы узнать есть ли у него задания на проверку или нет. Пока он не получит результат об очереди он будет складывать сообщения в свою локальную очередь заданий.

Если заданий нет и результата нет - клиент ждет проверки от сервера и переодически проверяет очердь.

Если задание приходит - клиент генерирует результат проверки и отправляет обратно на сервер.

Далее, после получения клиент начинает обрабатывать сообщения, полученные при ожидании ответа от очереди.
Если он встретил задание на проверку, то он его выполняет. 
Если пришел результат, то он в зависимости от результата он решает нужен ли новый проверяющий или нет и переходит к новой итерации написания кода.


## Описание программы на оценку 6-7

Логгирование было вынесено в отдельный класс. Функция выводит в консоль сервера и отправляет сообщение логгеру.

Логгер может подключиться как во время подключения клиентов, так и во время работы.
Отдельный поток занимается подключением логгера.

`logger.cpp` - файл логгера

`client_6.cpp` - файл клиента

## Описание программы на оценку 8

Вместо того чтобы ждать 1 логгера, программа хранит вектор подключенных сокетов логгеров и рассылает им лог сообщения.
А так логика такая же как и в решении на 6-7.
Ничего не поменялось, кроме сервера - новый файл `server_8.cpp`. Логгер и клиент остались из решения на 6 баллов

## Описание на 9



## Описание на 10

